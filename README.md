# VMware
一些python开发的可以通过API方便管理VMware的集群的小工具

快照管理工具程序界面
![image](https://github.com/user-attachments/assets/9b5c596e-9e19-4eeb-80d1-b08f0ae6c00a)

快照管理工具 1.0 - 使用说明
1. 介绍
本工具用于管理 vCenter 中的虚拟机快照，支持：
•	连接 vCenter
•	删除快照（仅保留最新的2个快照）
•	创建快照（根据Excel配置文件决定是否包含内存）
2. 运行环境
本工具基于 Python 和 Tkinter 开发，并依赖以下库：
•	tkinter
•	pyVim.connect
•	pyVmomi
•	ssl
•	json
•	openpyxl（用于解析 Excel 配置文件）
3. 运行方式
在Windows下双击13.exe运行
4. 使用指南
4.1 连接 vCenter
1.	在 vCenter IP 输入框中输入 vCenter 的 IP 地址。
2.	输入 用户名 和 密码。
3.	点击 “连接 vCenter” 按钮。
4.	若连接成功，日志窗口会显示 ✅ 成功连接到 vCenter: <IP>。
📌 注意：工具会自动保存 vCenter 连接信息，下次打开时可直接选择已保存的 vCenter IP。
________________________________________
4.2 删除快照
1.	连接 vCenter 后，点击 “删除快照” 按钮。
2.	工具会自动扫描所有虚拟机，删除除最近2个快照外的所有快照。
3.	进度条会显示进度，日志窗口会实时更新执行状态。
________________________________________
4.3 创建快照
1.	上传 Excel 配置文件（配置文件随程序包一起发放）。
o	点击 “选择配置文件” 按钮，选择包含虚拟机快照策略的 Excel 文件（.xlsx）。
o	Excel 需包含： 
	VM Name（虚拟机名称）
	Include Memory（是否包含内存，True 或 False）
o	选择成功后，日志窗口会显示 ✅ 选择的配置文件: <文件路径>。
2.	开始创建快照
o	点击 “生成快照” 按钮，工具将按照 Excel 配置文件执行快照创建： 
	仅处理开机状态的虚拟机
	快照命名格式：Snapshot_YYYYMMDD_HHMMSS
	是否包含内存依据 Excel 配置文件
3.	进度条和日志窗口会实时显示快照创建状态。
________________________________________
5. 功能说明
功能	描述
连接 vCenter	连接到 vCenter，并保存多台 vCenter 记录
删除快照	仅保留最近 2 个快照，删除其余快照
创建快照	按照 Excel 配置的规则创建快照（可包含内存）
进度显示	进度条实时显示任务进度
日志记录	状态窗口实时输出任务执行情况
________________________________________
6. 注意事项
•	vCenter 账户需具备管理虚拟机快照的权限。
•	Excel 配置文件格式必须正确，否则会导致快照创建失败。
•	删除快照操作不可逆，请谨慎使用！
•	软件会保存 vCenter 连接信息，若有安全顾虑可手动删除 vcenter_config.json 文件。
________________________________________
📌 本工具适用于 VMware vCenter 环境，适合管理员批量管理快照。
